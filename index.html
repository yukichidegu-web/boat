<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>1ã‚³ãƒ¼ã‚¹ç‰¹åŒ–ãƒ»æœŸå¾…å€¤æœ€å¤§åŒ–ãƒ„ãƒ¼ãƒ«</title>
<style>
:root{
  --buy:#16a34a; --skip:#2563eb; --ng:#ef4444; --bg:#f2f2f7;
}
body{font-family:-apple-system,BlinkMacSystemFont; background:var(--bg); margin:0; padding:14px;}
h1{font-size:18px; text-align:center; margin:8px 0 12px;}
.card{background:#fff; border-radius:14px; padding:14px; margin-bottom:12px;}
label{font-size:12px; color:#444;}
input,select{
  width:100%; font-size:18px; padding:10px; margin:6px 0 10px;
  border-radius:10px; border:1px solid #d1d5db;
}
button{
  width:100%; padding:14px; font-size:18px; border:none; border-radius:14px;
  background:#111827; color:#fff;
}
.row{display:flex; gap:10px;}
.badge{padding:6px 10px; border-radius:999px; font-size:12px; color:#fff;}
.badge.buy{background:var(--buy);}
.badge.skip{background:var(--skip);}
.badge.ng{background:var(--ng);}
#result{ text-align:center; font-size:22px; font-weight:800; margin-top:8px;}
.sub{font-size:14px; font-weight:500;}
.kpi{display:flex; gap:10px; justify-content:space-between; font-size:12px;}
.kpi div{background:#f8fafc; border-radius:10px; padding:8px; flex:1; text-align:center;}
.ok{color:var(--buy);} .no{color:var(--ng);}
.small{font-size:12px; color:#555;}
hr{border:none; border-top:1px solid #e5e7eb; margin:10px 0;}
table{width:100%; border-collapse:collapse; font-size:12px;}
th,td{border-bottom:1px solid #e5e7eb; padding:6px; text-align:center;}
.actions{display:flex; gap:10px;}
.ghost{background:#e5e7eb; color:#111827;}
</style>
</head>
<body>

<h1>ğŸš¤ 1ã‚³ãƒ¼ã‚¹ç‰¹åŒ–ãƒ»æœŸå¾…å€¤æœ€å¤§åŒ–</h1>

<div class="card">
  <div class="row">
    <div style="flex:1">
      <label>é–‹å‚¬å ´ï¼ˆ1ã‚³ãƒ¼ã‚¹æœ‰åˆ©å ´ã®ã¿ï¼‰</label>
      <select id="track">
        <option value="OK">ä½ä¹‹æ±Ÿ / èŠ¦å±‹ / å¤§æ‘ / é³´é–€ / ä¸‰å›½(æ¡ä»¶)</option>
        <option value="NG">ä¸Šè¨˜ä»¥å¤–ï¼ˆä½¿ç”¨ä¸å¯ï¼‰</option>
      </select>
    </div>
    <div>
      <label>é€²å…¥</label>
      <select id="entry">
        <option value="OK">æ ãªã‚Š</option>
        <option value="NG">å´©ã‚Œæƒ³å®š</option>
      </select>
    </div>
  </div>

  <label>1å·è‰‡ å±•ç¤ºã‚¿ã‚¤ãƒ </label>
  <input id="t1" placeholder="6.70">

  <label>å±•ç¤º1ä½ ã‚¿ã‚¤ãƒ </label>
  <input id="tTop" placeholder="6.65">

  <div class="row">
    <div style="flex:1">
      <label>2é€£å˜ 1â†’2 ã‚ªãƒƒã‚ºï¼ˆâ‰¥6.0ï¼‰</label>
      <input id="o12" placeholder="6.8">
    </div>
    <div style="flex:1">
      <label>2é€£å˜ 1â†’3 ã‚ªãƒƒã‚ºï¼ˆâ‰¥6.0ï¼‰</label>
      <input id="o13" placeholder="9.5">
    </div>
  </div>

  <div class="kpi">
    <div>å±•ç¤ºå·® â‰¤0.10 <div id="k1" class="no">æœª</div></div>
    <div>é€²å…¥/å ´ <div id="k2" class="no">æœª</div></div>
    <div>ã‚ªãƒƒã‚º â‰¥6 <div id="k3" class="no">æœª</div></div>
  </div>

  <button onclick="judge()">åˆ¤å®š</button>
  <div id="result"></div>
</div>

<div class="card">
  <div class="row">
    <span class="badge buy">è²·ã„</span>
    <span class="badge skip">è¦‹é€ã‚Š</span>
    <span class="badge ng">å¼·åˆ¶NG</span>
  </div>
  <hr>
  <div class="actions">
    <button class="ghost" onclick="saveLog('WIN')">çš„ä¸­</button>
    <button class="ghost" onclick="saveLog('LOSE')">ä¸çš„ä¸­</button>
    <button class="ghost" onclick="exportCSV()">CSV</button>
  </div>
  <div class="small">â€» è²·ã„è¡¨ç¤ºæ™‚ã®ã¿è¨˜éŒ²ã€‚é‡‘é¡ã¯è‡ªå‹•é…åˆ†ã€‚</div>
  <hr>
  <table>
    <thead><tr><th>æ—¥æ™‚</th><th>çµæœ</th><th>ç‚¹æ•°</th><th>æŠ•è³‡</th></tr></thead>
    <tbody id="log"></tbody>
  </table>
</div>

<script>
const BET_UNIT = 1000; // 1ç‚¹ã‚ãŸã‚Š
const ODDS_MIN = 6.0;

function setKPI(){
  k1.textContent='æœª'; k1.className='no';
  k2.textContent='æœª'; k2.className='no';
  k3.textContent='æœª'; k3.className='no';
}

function judge(){
  setKPI();
  const trackOK = track.value==='OK';
  const entryOK = entry.value==='OK';
  const t1v = parseFloat(t1.value);
  const tTopv = parseFloat(tTop.value);
  const o12v = parseFloat(o12.value);
  const o13v = parseFloat(o13.value);

  if([t1v,tTopv,o12v,o13v].some(v=>Number.isNaN(v))){
    result.innerHTML = "<div class='badge ng'>æ•°å€¤ä¸è¶³</div>";
    return;
  }

  // å¼·åˆ¶NG
  if(!trackOK || !entryOK){
    result.innerHTML = "<div class='badge ng'>å¼·åˆ¶NGï¼ˆå ´/é€²å…¥ï¼‰</div>";
    return;
  }

  const diff = t1v - tTopv;
  if(diff <= 0.10){ k1.textContent='OK'; k1.className='ok'; }

  const picks = [];
  if(o12v >= ODDS_MIN) picks.push('1â†’2');
  if(o13v >= ODDS_MIN) picks.push('1â†’3');
  if(picks.length){ k3.textContent='OK'; k3.className='ok'; }
  if(trackOK && entryOK){ k2.textContent='OK'; k2.className='ok'; }

  // æœ€çµ‚åˆ¤å®š
  if(diff <= 0.10 && picks.length){
    const stake = picks.length * BET_UNIT;
    result.innerHTML =
      "<div class='badge buy'>è²·ã„</div>" +
      `<div class='sub'>æ¨å¥¨ï¼š${picks.join(' / ')}<br>æŠ•è³‡ï¼š${stake.toLocaleString()}å††ï¼ˆå„${BET_UNIT.toLocaleString()}å††ï¼‰</div>`;
    window.__current = {picks:picks.length, stake};
  }else{
    result.innerHTML = "<div class='badge skip'>è¦‹é€ã‚Š</div>";
  }
}

function saveLog(res){
  if(!window.__current) return;
  const logs = JSON.parse(localStorage.getItem('brlog')||'[]');
  logs.unshift({
    d:new Date().toLocaleString(),
    r:res, p:window.__current.picks, s:window.__current.stake
  });
  localStorage.setItem('brlog', JSON.stringify(logs.slice(0,100)));
  renderLog();
}

function renderLog(){
  const logs = JSON.parse(localStorage.getItem('brlog')||'[]');
  log.innerHTML = logs.map(x=>`<tr><td>${x.d}</td><td>${x.r}</td><td>${x.p}</td><td>${x.s}</td></tr>`).join('');
}
renderLog();

function exportCSV(){
  const logs = JSON.parse(localStorage.getItem('brlog')||'[]');
  let csv = "date,result,picks,stake\n";
  logs.forEach(x=>csv+=`${x.d},${x.r},${x.p},${x.s}\n`);
  const blob = new Blob([csv],{type:'text/csv'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'boat_race_log.csv';
  a.click();
}
</script>

</body>
</html>